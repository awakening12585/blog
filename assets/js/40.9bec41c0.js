(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{183:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),a("p",[a("kbd",[a("a",{attrs:{href:"https://docs.mongodb.com/manual/reference/replica-configuration/#rsconf.settings.electionTimeoutMillis",target:"_blank",rel:"noopener noreferrer"}},[t._v("electionTimeoutMillis"),a("OutboundLink")],1)]),t._v(" 默认值为10000(10s) ，我们可以根据自己的项目情况来升高或者降低该值，我们在更改该值的时候需要考虑到网络延迟等因素。")]),t._v(" "),a("p",[t._v("默认情况下，副本集在选取新的主节点的等待时间不超过12秒(主要用于将原有主节点标记为不可用，并选举出新的主节点)。")]),t._v(" "),a("p",[t._v("为了保持次节点与主节点的数据同步，MongoDB 使用两种方式进行数据的同步：")]),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),a("p",[a("kbd",[a("a",{attrs:{href:"https://www.cnblogs.com/operationhome/p/10688798.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("MongoDB-Oplog详解"),a("OutboundLink")],1)])]),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),a("p",[a("kbd",[a("a",{attrs:{href:"https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-ubuntu1604-4.0.13.tgz",target:"_blank",rel:"noopener noreferrer"}},[t._v("安装包下载地址"),a("OutboundLink")],1)])]),t._v(" "),t._m(15),t._v(" "),t._m(16),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),t._v(" "),t._m(21),t._v(" "),t._m(22),t._m(23),t._v(" "),t._m(24),t._m(25),t._v(" "),t._m(26),t._m(27),t._v(" "),t._m(28),t._m(29),t._v(" "),t._m(30),t._v(" "),t._m(31),t._m(32),t._v(" "),t._m(33),t._v(" "),t._m(34),t._m(35),t._m(36),t._v(" "),t._m(37),t._v(" "),t._m(38),t._m(39),t._v(" "),t._m(40),t._m(41),t._v(" "),t._m(42),t._m(43),t._v(" "),t._m(44),a("p",[t._v("至此MongoDB副本集已经搭建完成")])])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"mongodb副本集搭建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mongodb副本集搭建","aria-hidden":"true"}},[this._v("#")]),this._v(" MongoDB副本集搭建")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"一、mongodb副本集简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、mongodb副本集简介","aria-hidden":"true"}},[this._v("#")]),this._v(" 一、MongoDB副本集简介")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("单节点的 "),s("kbd",[this._v("MongoDB")]),this._v(" 在数据的安全和冗余方面是比较低的，在生产环境中，我们为 "),s("kbd",[this._v("MongoDB")]),this._v("  配置副本集，这样可以提高数据的高可用性和安全性。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("副本集 ：是一组 "),s("kbd",[this._v("Mongod")]),this._v(" 维护相同数据集的实例。副本集可以包含多个数据承载点和多个仲裁点。在承载数据的节点中，仅有一个节点被视为主节点，其他节点称为次节点。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("==Primary 主节点，用于承担==")]),this._v(" "),s("li",[this._v("==Secondary 次节点==")]),this._v(" "),s("li",[this._v("==Arbiter 仲裁节点，也是属于次节点==")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("主节点接收所有的数据写入操作，主节点记录数据的所有更改，即"),s("kbd",[this._v("oplog")]),this._v("。")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[a("p",[t._v("一个主节点两个次节点(一个"),a("kbd",[t._v("Secondary")]),t._v(" 节点，一个"),a("kbd",[t._v("Arbiter")]),t._v(" 节点)\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20191022114327217.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8yODg0NjM2Nw==,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}}),t._v("\n将一个额外的"),a("kbd",[t._v("mongod")]),t._v("实例添加到副本集作为 仲裁节点。仲裁节点不维护数据集。仲裁节点的目的是通过响应其他副本集成员的心跳和选举请求来维护副本集中的选举。因为它们不存储数据集，所以仲裁节点可以是提供副本集仲裁功能的好方法，其资源成本比具有数据集的全功能副本集成员更低。如果您的副本集具有偶数个成员，请添加仲裁者以避免脑裂出现。")])]),t._v(" "),a("li",[a("p",[t._v("主节点故障后重新选举主节点\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20191022114550461.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8yODg0NjM2Nw==,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}}),t._v("\n在主节点未与配置中的其它成员通信超过 10s(默认为10s)的话，则符合条件的次节点将推选自己为主节点。")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("在选举成功完成之前，副本集无法处理写入操作。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("初始同步， 用于同步主节点的所有数据")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("初始同步将所有的数据从副本集的一个成员复制到另外一个成员")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("增量同步，在初始同步后不断复制新的数据")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("在初始同步后不断复制数据，次节点从主节点中同步复制 Oplog，并在异步过程中应用这些操作")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("副本集在部署前需要确定成员数据，副本集最多能有50个节点，但是只能有7个节点拥有被选举权，副本集需要具有奇数个投票成员，如果有偶数个的话，可以添加一个 仲裁者，来保证有奇数个成员，避免脑裂情况发生。\n尽量使用 主机名 来寻找对应的节点，而不是使用 ip 地址，避免 ip 改变导致配置需要更改。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"二、部署准备"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、部署准备","aria-hidden":"true"}},[this._v("#")]),this._v(" 二、部署准备")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("kbd",[this._v("1.部署需要更改 /etc/hosts 文件，将主机名和 ip 地址对应好，不应该使用ip。\n2.使用统一的端口。\n3.创建数据储存的位置、日志储存位置和配置文件的位置。\n4.确定好副本集的名称\n5.提前生成keyfile文件\n6.前往官网下载安装包（本次教程使用的是官网编译的包，解压直接使用）")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("配置服务器hosts文件")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v("vim "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hosts\ntest1 192"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("168"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("11"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("替换为真是ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntest1 192"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("168"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("12"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("替换为真是ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntest1 192"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("168"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("13"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("替换为真是ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("将下载好的安装包上传至服务器并解压\n"),s("img",{attrs:{src:"https://img-blog.csdnimg.cn/20191022121949656.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8yODg0NjM2Nw==,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("解压后将目录复制3份，分别命名为：mongodb-4.0.12-PRIMARY、mongodb-4.0.12-SECONDARY、mongodb-4.0.12-ARBITER，并将目录移动至/data目录下")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("=="),s("strong",[this._v("注：本次搭建副本集为测试环境，在一台服务器上完成的搭建，如需在正式环境下搭建将其余两个节点分发至不同服务器即可")]),this._v("==")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("创建数据库相关目录")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("提前创建好相关目录：db为数据库数据存储目录，logs为数据库日志存放目录，etc为数据库配置文件存放目录")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v("mkdir "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongodb"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("12"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("PRIMARY"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("logs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nmkdir "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongodb"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("12"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("SECONDARY"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("logs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nmkdir "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongodb"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("12"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ARBITER"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("logs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("生成keyfile文件并将文件分发至3台服务器内数据库etc目录下")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v("openssl rand "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("base64 90 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("out "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("tools"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("keyfile\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("更改三个节点的 "),s("kbd",[this._v("keyFile")]),this._v(" 文件权限")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v("chmod 600 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongodb"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("12"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("PRIMARY"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("keyfile\nchmod 600 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongodb"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("12"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("SECONDARY"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("keyfile\nchmod 600 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongodb"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("12"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ARBITER"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("keyfile\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("上述准备工作完成之后，首次启动通过命令方式分别启动数据库")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongodb"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("12"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("PRIMARY"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongod "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("dbpath="),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongodb"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("12"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("PRIMARY"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("db "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("logpath="),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongodb"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("12"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("PRIMARY"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("logs"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("fork "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("port 27017\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("=="),s("strong",[this._v("--dbpath:指定数据库存储位置\n--logpath:指定日志存放位置\n--fork:后台运行\n--port:指定运行端口，如不指定为默认端口27017")]),this._v("==")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("启动后匿名登录创建管理员账号")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongodb"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("12"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("PRIMARY"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongo\n\nuse admin\n\ndb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("createUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("user:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pwd")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"密码"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("roles: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" role: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" db: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"admin"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("=="),s("strong",[this._v("3台数据库服务都需要使用此方法创建管理员用户")]),this._v("==")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("管理员用户创建成功后，重启MongoDB服务（首先kill掉MongoDB数据库服务,然后通过添加下方配置文件内容来启动服务）")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ef "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" grep mongo "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" awk "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{print $2}'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" grep "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("v grep "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" xargs "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("kill")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("9 \n\nvim "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongodb"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("12"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("PRIMARY"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongod"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("conf\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mongod.conf")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# for documentation of all options, see:")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   http://docs.mongodb.org/manual/reference/configuration-options/")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Where and how to store data.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("storage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dbPath")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /data/mongodb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("4.0.12"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("PRIMARY/db\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("journal")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("enabled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  engine:")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  mmapv1:")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  wiredTiger:")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# where to write logging data.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("systemLog")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("destination")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" file\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("logAppend")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /data/mongodb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("4.0.12"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("PRIMARY/logs/mongodb.logs\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# network interfaces")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("net")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("27017")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("bindIp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 0.0.0.0\n\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("processManagement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("fork")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("security")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("authorization")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" enabled\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("keyFile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/data/mongodb-4.0.12-PRIMARY/etc/keyfile"')]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# clusterAuthMode: "keyFile"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#operationProfiling:")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("replication")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("replSetName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" smart360\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#sharding:")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Enterprise-Only Options:")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#auditLog:")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#snmp:")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#auth=ture")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br"),a("span",{staticClass:"line-number"},[t._v("31")]),a("br"),a("span",{staticClass:"line-number"},[t._v("32")]),a("br"),a("span",{staticClass:"line-number"},[t._v("33")]),a("br"),a("span",{staticClass:"line-number"},[t._v("34")]),a("br"),a("span",{staticClass:"line-number"},[t._v("35")]),a("br"),a("span",{staticClass:"line-number"},[t._v("36")]),a("br"),a("span",{staticClass:"line-number"},[t._v("37")]),a("br"),a("span",{staticClass:"line-number"},[t._v("38")]),a("br"),a("span",{staticClass:"line-number"},[t._v("39")]),a("br"),a("span",{staticClass:"line-number"},[t._v("40")]),a("br"),a("span",{staticClass:"line-number"},[t._v("41")]),a("br"),a("span",{staticClass:"line-number"},[t._v("42")]),a("br"),a("span",{staticClass:"line-number"},[t._v("43")]),a("br"),a("span",{staticClass:"line-number"},[t._v("44")]),a("br"),a("span",{staticClass:"line-number"},[t._v("45")]),a("br"),a("span",{staticClass:"line-number"},[t._v("46")]),a("br"),a("span",{staticClass:"line-number"},[t._v("47")]),a("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("=="),s("strong",[this._v("3台服务器分别创建mongod.conf配置文件，内部参数根据自己实际目录而修改")]),this._v("==")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("配置文件编辑好后分别启动3台数据库")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongodb"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("12"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("PRIMARY"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongo "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("f "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongodb"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("12"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("PRIMARY"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongod"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("conf\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("通过管理员的身份登录数据库")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongodb"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("12"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("PRIMARY"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mongo localhost:27017"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("admin "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("u root "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("p\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("输入创建管理员用户时的密码\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("创建副本集，主节点操作")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v(">rs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("initiate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("_id:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("members: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" _id: 0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" host: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test1:27017"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ok"')]),t._v(" : 1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#(返回次结果表示创建成功)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#多次按下回车键，直到显示这个节点为Primary主节点")]),t._v("\ntest:PRIMARY>\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#接下来添加备节点")]),t._v("\ntest:PRIMARY> rs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test2:27017'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ok"')]),t._v(" : 1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"operationTime"')]),t._v(" : Timestamp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("1555663440"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$clusterTime")]),t._v('"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"clusterTime"')]),t._v(" : Timestamp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("1555663440"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"signature"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hash"')]),t._v(" : BinData"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"AAAAAAAAAAAAAAAAAAAAAAAAAAA="')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"keyId"')]),t._v(" : NumberLong"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#添加仲裁节点")]),t._v("\ntest:PRIMARY> rs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("addArb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test3:27017"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ok"')]),t._v(" : 1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"operationTime"')]),t._v(" : Timestamp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("1555663631"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$clusterTime")]),t._v('"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"clusterTime"')]),t._v(" : Timestamp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("1555663631"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"signature"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hash"')]),t._v(" : BinData"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"AAAAAAAAAAAAAAAAAAAAAAAAAAA="')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"keyId"')]),t._v(" : NumberLong"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看当前配置")]),t._v("\ntest:PRIMARY> rs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看各节点身份")]),t._v("\ntest:PRIMARY> rs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br"),a("span",{staticClass:"line-number"},[t._v("31")]),a("br"),a("span",{staticClass:"line-number"},[t._v("32")]),a("br"),a("span",{staticClass:"line-number"},[t._v("33")]),a("br"),a("span",{staticClass:"line-number"},[t._v("34")]),a("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("次节点数据库操作")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v("test:SECONDARY> show dbs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 我们发现无法读写")]),t._v("\n2019"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("10"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("22T14:40:40"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("852"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("0800 E QUERY    "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[js]")]),t._v(" Error: listDatabases failed:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"operationTime"')]),t._v(" : Timestamp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("1555664675"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ok"')]),t._v(" : 0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"errmsg"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"not master and slaveOk=false"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"code"')]),t._v(" : 13435"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"codeName"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"NotMasterNoSlaveOk"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$clusterTime")]),t._v('"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"clusterTime"')]),t._v(" : Timestamp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("1555664675"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"signature"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hash"')]),t._v(" : BinData"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"AAAAAAAAAAAAAAAAAAAAAAAAAAA="')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"keyId"')]),t._v(" : NumberLong"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \ntest:SECONDARY> rs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("slaveOk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 允许 次节点 进行读取")]),t._v("\ntest:SECONDARY> show dbs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 我们就可以查看到次节点的数据了")]),t._v("\nadmin   0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("000GB\nconfig  0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("000GB\nlocal   0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("000GB\ntest    0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("000GB\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br")])])}],!1,null,null,null);s.default=e.exports}}]);