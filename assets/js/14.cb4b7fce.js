(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{209:function(s,a,n){"use strict";n.r(a);var t=n(0),e=Object(t.a)({},function(){var s=this.$createElement;this._self._c;return this._m(0)},[function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("div",{staticClass:"content"},[n("h1",{attrs:{id:"mongodb"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mongodb","aria-hidden":"true"}},[s._v("#")]),s._v(" mongodb")]),s._v(" "),n("p",[s._v("使用docker-compose 部署mongodb")]),s._v(" "),n("h2",{attrs:{id:"路径约定"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#路径约定","aria-hidden":"true"}},[s._v("#")]),s._v(" 路径约定")]),s._v(" "),n("ul",[n("li",[s._v("data 目录:存放mongodb数据")]),s._v(" "),n("li",[s._v("setup 目录:\n"),n("ul",[n("li",[s._v("mongdbInit.sh 初始化脚本")])])]),s._v(" "),n("li",[s._v("docker-compose.yml 文件")])]),s._v(" "),n("h2",{attrs:{id:"创建目录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建目录","aria-hidden":"true"}},[s._v("#")]),s._v(" 创建目录")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("//创建mongodb主目录\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /usr/local/docker/mongodb\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/docker/mongodb\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" data "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" setup\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h2",{attrs:{id:"docker-compose-yml"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-yml","aria-hidden":"true"}},[s._v("#")]),s._v(" docker-compose.yml")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("version: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3"')]),s._v("\nservices:\n  mongo:\n    image: mongo:4.0.1\n    container_name: mongodb\n    ports:\n      - "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"27017:27017"')]),s._v("\n    environment:\n      - "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TZ")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Asia/Shanghai\n      - "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MONGO_INITDB_ROOT_USERNAME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("test\n      - "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MONGO_INITDB_ROOT_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("test123\n      - "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MONGO_INITDB_DATABASE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("cs\n    volumes:\n      - "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./data/db/:/data/db"')]),s._v("\n      - "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./setup:/docker-entrypoint-initdb.d/"')]),s._v("\n    command: "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mongod"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--bind_ip"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.0.0.0"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("h2",{attrs:{id:"mongdbinit-sh"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mongdbinit-sh","aria-hidden":"true"}},[s._v("#")]),s._v(" mongdbInit.sh")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Creating mongo users"')]),s._v("\nmongo admin --host localhost -u "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -p test123 --eval "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"db.createUser({user: 'admin',pwd: 'admin123',roles: [{ role: 'dbAdminAnyDatabase', db: 'admin'}]});\"")]),s._v("\nmongo admin -u admin -p admin123 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\ndb = db.getSiblingDB('cs'); \ndb.createUser({user: 'cs',pwd: 'cs360',roles: [{ role: \"readWrite\", db: \"cs\"}]})\ndb.createCollection(\"cs\");\nEOF")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mongo users created"')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h2",{attrs:{id:"启动"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动","aria-hidden":"true"}},[s._v("#")]),s._v(" 启动")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("docker-compose up -d\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"mongodb用户角色权限说明"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mongodb用户角色权限说明","aria-hidden":"true"}},[s._v("#")]),s._v(" mongoDb用户角色权限说明")]),s._v(" "),n("ul",[n("li",[s._v("数据库用户角色 read、readWrite")]),s._v(" "),n("li",[s._v("数据库管理角色 dbAdmin、dbOwner、userAdmin")]),s._v(" "),n("li",[s._v("集群管理角色 clusterAdmin、clusterManager、clusterMonitor、 hostManager")]),s._v(" "),n("li",[s._v("备份恢复角色 backup、restore")]),s._v(" "),n("li",[s._v("所有数据库角色 readAnyDatabase、readWriteAnyDatabase、userAdminAnyDatabase、dbAdminAnyDatabase")]),s._v(" "),n("li",[s._v("超级用户角色 root")]),s._v(" "),n("li",[s._v("内部角色 __system")])]),s._v(" "),n("h3",{attrs:{id:"角色说明"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#角色说明","aria-hidden":"true"}},[s._v("#")]),s._v(" 角色说明")]),s._v(" "),n("ul",[n("li",[s._v("Read 允许用户读取指定数据库")]),s._v(" "),n("li",[s._v("readWrite 允许用户读写指定数据库")]),s._v(" "),n("li",[s._v("dbAdmin 允许用户在指定数据库中执行管理函数，如索引创建、删除，查看统计或访问system.profile")]),s._v(" "),n("li",[s._v("userAdmin 允许用户向system.users集合写入，可以找指定数据库里创建、删除和管理用户")]),s._v(" "),n("li",[s._v("clusterAdmin 只在admin数据库中可用，赋予用户所有分片和复制集相关函数的管理权限。")]),s._v(" "),n("li",[s._v("readAnyDatabase 只在admin数据库中可用，赋予用户所有数据库的读权限")]),s._v(" "),n("li",[s._v("readWriteAnyDatabase 只在admin数据库中可用，赋予用户所有数据库的读写权限")]),s._v(" "),n("li",[s._v("userAdminAnyDatabase 只在admin数据库中可用，赋予用户所有数据库的userAdmin权限")]),s._v(" "),n("li",[s._v("dbAdminAnyDatabase 只在admin数据库中可用，赋予用户所有数据库的dbAdmin权限。")]),s._v(" "),n("li",[s._v("root 只在admin数据库中可用。超级账号，超级权限\n至此mongoDb数据库据安装好了，可以愉快的玩耍使用了")])])])}],!1,null,null,null);a.default=e.exports}}]);